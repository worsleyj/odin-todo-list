import { resetDisplay } from "./sidebar";

const selection = document.querySelector(".selected-item");

function checkComplete(selectedItem, completeStatus) {
    if(selectedItem.isComplete) {
        completeStatus.textContent = "✅";
    } else completeStatus.textContent = "❌";
}

function editButton(selectedItem) {
    const editModal = document.querySelector(".edit-note");
    const editTitle = document.querySelector("#edit-title");
    const editDesc = document.querySelector("#edit-desc");
    const editDate = document.querySelector("#edit-date");
    const editPriority = document.querySelector("#edit-priority");

    editTitle.value = selectedItem.title;
    editDesc.value = selectedItem.desc;
    editDate.value = selectedItem.dueDate;
    editPriority.value = selectedItem.priority;

    const submitEditBtn = document.querySelector(".submit-edit");
    submitEditBtn.addEventListener("click", () => {
        selectedItem.title = editTitle.value;
        selectedItem.desc = editDesc.value;
        selectedItem.dueDate = editDate.value;
        selectedItem.priority = editPriority.value;
        resetDisplay();
        displaySelectedItem(selectedItem);
    })
    editModal.showModal();
}

function displaySelectedItem(selectedItem) {
    selection.textContent = "";
    const itemContainer = document.createElement("div");
    const itemTitle = document.createElement("h1");
    const itemDesc = document.createElement("p");
    const itemDueDate = document.createElement("div");
    const itemPriority = document.createElement("div");
    const completeStatus = document.createElement("div");
    const toggleComplete = document.createElement("button");
    const editBtn = document.createElement("button");

    itemTitle.textContent = selectedItem.title;
    itemDesc.textContent = selectedItem.desc;
    itemDueDate.textContent = selectedItem.dueDate;
    itemPriority.textContent = selectedItem.priority;

    editBtn.textContent = "Edit Note";
    editBtn.addEventListener("click", () => editButton(selectedItem));

    checkComplete(selectedItem, completeStatus);
    toggleComplete.textContent = "Mark as Completed";
    toggleComplete.addEventListener("click", () => {
        if (selectedItem.isComplete) {
            selectedItem.isComplete = false;
        } else {
            selectedItem.isComplete = true;
        }
        checkComplete(selectedItem, completeStatus);
    })


    selection.append(itemContainer);
    itemContainer.append(itemTitle, itemDesc, itemDueDate, itemPriority, editBtn, completeStatus, toggleComplete);
}

export { displaySelectedItem };